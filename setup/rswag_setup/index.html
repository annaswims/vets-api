
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation for Vets API deployment, setup, and history.">
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.1, mkdocs-material-8.1.11">
    
    
      
        <title>Rswag setup for Rails engine - Vets API</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.50e68009.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#rswag-setup-for-rails-engine" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Vets API" class="md-header__button md-logo" aria-label="Vets API" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Vets API
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Rswag setup for Rails engine
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/department-of-veterans-affairs/vets-api" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Vets API" class="md-nav__button md-logo" aria-label="Vets API" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Vets API
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/department-of-veterans-affairs/vets-api" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_1">
          Deployment
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Deployment" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Deployment
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../deployment/information/" class="md-nav__link">
        Information
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Setup
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Setup" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Setup
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../betamocks/" class="md-nav__link">
        Betamocks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../debugging_with_docker_rubymine_windows/" class="md-nav__link">
        Debugging with Docker RubyMine Windows
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_3" type="checkbox" id="__nav_2_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_3">
          Developer Setup
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Developer Setup" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_3">
          <span class="md-nav__icon md-icon"></span>
          Developer Setup
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../hybrid/" class="md-nav__link">
        Hybrid Developer Setup
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../native/" class="md-nav__link">
        Native Developer Setup
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../docker/" class="md-nav__link">
        Docker
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../edu_benefits/" class="md-nav__link">
        Education Benefits Year to Date Report
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../evss/" class="md-nav__link">
        EVSS S3 Uploads
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../facilities_locator/" class="md-nav__link">
        Facilities Locator Setup
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../local_network_access/" class="md-nav__link">
        Local Network Access
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mailer/" class="md-nav__link">
        Mailers Info
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mhv/" class="md-nav__link">
        MHV Prescriptions and MHV Secure Messaging Setup
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mpi/" class="md-nav__link">
        MPI Service
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Rswag setup for Rails engine
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Rswag setup for Rails engine
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#rswag-setup-for-rails-engine" class="md-nav__link">
    Rswag setup for Rails engine
  </a>
  
    <nav class="md-nav" aria-label="Rswag setup for Rails engine">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#misc-details" class="md-nav__link">
    Misc details
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_13" type="checkbox" id="__nav_2_13" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_13">
          Running the App
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Running the App" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_13">
          <span class="md-nav__icon md-icon"></span>
          Running the App
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../running_docker/" class="md-nav__link">
        Running the app with Docker
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../running_natively/" class="md-nav__link">
        Running the app Natively
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../virtual_machine_access/" class="md-nav__link">
        Virtual Machine Access
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../HISTORY/" class="md-nav__link">
        History
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#rswag-setup-for-rails-engine" class="md-nav__link">
    Rswag setup for Rails engine
  </a>
  
    <nav class="md-nav" aria-label="Rswag setup for Rails engine">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#misc-details" class="md-nav__link">
    Misc details
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
<a href="https://github.com/department-of-veterans-affairs/vets-api/edit/main/docs/setup/rswag_setup.md" title="Edit this page" class="md-content__button md-icon">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
</a>


  <h1>Rswag setup for Rails engine</h1>

<h2 id="rswag-setup-for-rails-engine">Rswag setup for Rails engine<a class="headerlink" href="#rswag-setup-for-rails-engine" title="Permanent link">&para;</a></h2>
<p>To create a minimal implementation of Rswag in your team's Rails engine you will need to do the following (commented lines are only for explaining what specific things do and should be removed from your specific implementation):</p>
<ul>
<li>In <code>/spec/swagger_helper.rb</code> add your Rails Engine's name eg <code>AppealsApi</code> to the <code>config.swagger_docs</code> section.</li>
<li>Create your Rswag config file in your engine's <code>spec/support</code> dir (eg <code>/modules/appeals_api/spec/support/rswag_config.rb</code>) a minimal configuration is as follows:</li>
</ul>
<div class="language-ruby highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># /modules/appeals_api/spec/support/rswag_config.rb</span>

<span class="k">class</span> <span class="nc">AppealsApi</span><span class="o">::</span><span class="no">RswagConfig</span>
  <span class="k">def</span> <span class="nf">config</span>
    <span class="p">{</span>
      <span class="s1">&#39;modules/appeals_api/app/swagger/appeals_api/v2/swagger.json&#39;</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="c1"># ^ This path points to wherever you would like Rswag to save the generated swagger json file.</span>
        <span class="ss">openapi</span><span class="p">:</span> <span class="s1">&#39;3.0.1&#39;</span><span class="p">,</span>
        <span class="ss">info</span><span class="p">:</span> <span class="p">{</span>
          <span class="ss">title</span><span class="p">:</span> <span class="s1">&#39;Decision Reviews&#39;</span><span class="p">,</span>
          <span class="ss">version</span><span class="p">:</span> <span class="s1">&#39;v2&#39;</span><span class="p">,</span>
          <span class="ss">termsOfService</span><span class="p">:</span> <span class="s1">&#39;https://developer.va.gov/terms-of-service&#39;</span><span class="p">,</span>
          <span class="ss">description</span><span class="p">:</span> <span class="no">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="no">AppealsApi</span><span class="o">::</span><span class="no">Engine</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;app&#39;</span><span class="p">,</span> <span class="s1">&#39;swagger&#39;</span><span class="p">,</span> <span class="s1">&#39;appeals_api&#39;</span><span class="p">,</span> <span class="s1">&#39;v2&#39;</span><span class="p">,</span> <span class="s1">&#39;api_description.md&#39;</span><span class="p">))</span>
          <span class="c1"># ^ You could have the description inline, but saving it as a standalone file makes it easier to edit/manage</span>
        <span class="p">},</span>
        <span class="ss">tags</span><span class="p">:</span> <span class="o">[</span>
          <span class="p">{</span>
            <span class="nb">name</span><span class="p">:</span> <span class="s1">&#39;Higher-Level Reviews&#39;</span><span class="p">,</span>
            <span class="ss">description</span><span class="p">:</span> <span class="s1">&#39;&#39;</span>
          <span class="p">}</span>
          <span class="c1"># ^ These tags are used for grouping each individual endpoint in the swagger UI</span>
        <span class="o">]</span><span class="p">,</span>
        <span class="ss">components</span><span class="p">:</span> <span class="p">{</span>
          <span class="ss">securitySchemes</span><span class="p">:</span> <span class="p">{</span>
            <span class="c1"># ^ add your relevant security schemes here</span>
            <span class="ss">apikey</span><span class="p">:</span> <span class="p">{</span>
              <span class="ss">type</span><span class="p">:</span> <span class="ss">:apiKey</span><span class="p">,</span>
              <span class="nb">name</span><span class="p">:</span> <span class="ss">:apikey</span><span class="p">,</span>
              <span class="k">in</span><span class="p">:</span> <span class="ss">:header</span>
            <span class="p">}</span>
          <span class="p">},</span>
          <span class="ss">schemas</span><span class="p">:</span> <span class="p">{</span>
            <span class="c1"># ^ schemas that can be used across multiple Rswag specs</span>
            <span class="s1">&#39;nonBlankString&#39;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span>
              <span class="s1">&#39;pattern&#39;</span><span class="p">:</span> <span class="s1">&#39;[^ </span><span class="se">\\</span><span class="s1">f</span><span class="se">\\</span><span class="s1">n</span><span class="se">\\</span><span class="s1">r</span><span class="se">\\</span><span class="s1">t</span><span class="se">\\</span><span class="s1">v</span><span class="se">\\</span><span class="s1">u00a0</span><span class="se">\\</span><span class="s1">u1680</span><span class="se">\\</span><span class="s1">u2000-</span><span class="se">\\</span><span class="s1">u200a</span><span class="se">\\</span><span class="s1">u2028</span><span class="se">\\</span><span class="s1">u2029</span><span class="se">\\</span><span class="s1">u202f</span><span class="se">\\</span><span class="s1">u205f</span><span class="se">\\</span><span class="s1">u3000</span><span class="se">\\</span><span class="s1">ufeff]&#39;</span><span class="p">,</span>
              <span class="s1">&#39;$comment&#39;</span><span class="p">:</span> <span class="s2">&quot;The pattern used ensures that a string has at least one non-whitespace character. The pattern comes from JavaScript&#39;s </span><span class="se">\\</span><span class="s2">s character class. </span><span class="se">\&quot;\\</span><span class="s2">s Matches a single white space character, including space, tab, form feed, line feed, and other Unicode spaces. Equivalent to [ </span><span class="se">\\</span><span class="s2">f</span><span class="se">\\</span><span class="s2">n</span><span class="se">\\</span><span class="s2">r</span><span class="se">\\</span><span class="s2">t</span><span class="se">\\</span><span class="s2">v</span><span class="se">\\</span><span class="s2">u00a0</span><span class="se">\\</span><span class="s2">u1680</span><span class="se">\\</span><span class="s2">u2000-</span><span class="se">\\</span><span class="s2">u200a</span><span class="se">\\</span><span class="s2">u2028</span><span class="se">\\</span><span class="s2">u2029</span><span class="se">\\</span><span class="s2">u202f</span><span class="se">\\</span><span class="s2">u205f</span><span class="se">\\</span><span class="s2">u3000</span><span class="se">\\</span><span class="s2">ufeff].</span><span class="se">\&quot;</span><span class="s2">: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions/Character_Classes  We are using simple character classes at JSON Schema&#39;s recommendation: https://tools.ietf.org/html/draft-handrews-json-schema-validation-01#section-4.3&quot;</span>
            <span class="p">}</span>
          <span class="p">}</span>
        <span class="p">},</span>
        <span class="ss">paths</span><span class="p">:</span> <span class="p">{},</span>
        <span class="ss">basePath</span><span class="p">:</span> <span class="s1">&#39;/services/appeals/v2/decision_reviews&#39;</span><span class="p">,</span>
        <span class="c1"># ^ basePath is used in building up the url that Rswag will use in testing</span>
        <span class="ss">servers</span><span class="p">:</span> <span class="o">[</span>
          <span class="c1"># ^ Used in creating the &#39;Environment&#39; drop-down for generating example curl commands</span>
          <span class="p">{</span>
            <span class="ss">url</span><span class="p">:</span> <span class="s1">&#39;https://dev-api.va.gov/services/appeals/{version}/decision_reviews&#39;</span><span class="p">,</span>
            <span class="ss">description</span><span class="p">:</span> <span class="s1">&#39;VA.gov API sandbox environment&#39;</span><span class="p">,</span>
            <span class="ss">variables</span><span class="p">:</span> <span class="p">{</span>
              <span class="ss">version</span><span class="p">:</span> <span class="p">{</span>
                <span class="ss">default</span><span class="p">:</span> <span class="s1">&#39;v2&#39;</span>
              <span class="p">}</span>
            <span class="p">}</span>
          <span class="p">}</span>
        <span class="o">]</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></td></tr></table></div>
<ul>
<li>Add your engines rake task to <code>rakelib/rswag.rake</code> by copy and pasting the following (substituting your relevant Rails engine in):</li>
</ul>
<div class="language-ruby highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># rakelib/rswag.rake</span>

<span class="n">namespace</span> <span class="ss">:rswag</span> <span class="k">do</span>

  <span class="c1"># ...</span>

  <span class="n">namespace</span> <span class="ss">:appeals_api</span> <span class="k">do</span>
    <span class="n">desc</span> <span class="s1">&#39;Generate rswag docs for appeals_api&#39;</span>
    <span class="n">task</span> <span class="ss">run</span><span class="p">:</span> <span class="ss">:environment</span> <span class="k">do</span>
      <span class="no">ENV</span><span class="o">[</span><span class="s1">&#39;PATTERN&#39;</span><span class="o">]</span> <span class="o">=</span> <span class="s1">&#39;modules/appeals_api/spec/docs/**/*_spec.rb&#39;</span>
      <span class="c1"># ^ specifies the path of the specs you&#39;d like Rswag to run</span>
      <span class="no">ENV</span><span class="o">[</span><span class="s1">&#39;RAILS_MODULE&#39;</span><span class="o">]</span> <span class="o">=</span> <span class="s1">&#39;appeals_api&#39;</span>
      <span class="c1"># ^ added to make Rswag only write out swagger json relevant to your Rails engine</span>
      <span class="no">ENV</span><span class="o">[</span><span class="s1">&#39;SWAGGER_DRY_RUN&#39;</span><span class="o">]</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span>
      <span class="c1"># ^ Turns off the dry Rswag option - https://github.com/rswag/rswag#dry-run-option</span>
      <span class="no">Rake</span><span class="o">::</span><span class="no">Task</span><span class="o">[</span><span class="s1">&#39;rswag:specs:swaggerize&#39;</span><span class="o">].</span><span class="n">invoke</span>
      <span class="c1"># ^ call the actual rswag rake task</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></td></tr></table></div>
<ul>
<li>Create a new spec file for your Rswag specs</li>
</ul>
<div class="language-ruby highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  1</span>
<span class="normal">  2</span>
<span class="normal">  3</span>
<span class="normal">  4</span>
<span class="normal">  5</span>
<span class="normal">  6</span>
<span class="normal">  7</span>
<span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># /modules/appeals_api/spec/docs/v2/hlr_spec.rb</span>

<span class="nb">require</span> <span class="s1">&#39;swagger_helper&#39;</span>
<span class="c1"># ^ standard Rswag helper</span>
<span class="nb">require</span> <span class="no">Rails</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;spec&#39;</span><span class="p">,</span> <span class="s1">&#39;rswag_override.rb&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_s</span>
<span class="c1"># ^ Rswag overrides to allow for multiple body examples and only writing out relevant swagger json (instead of writing all swagger json files out every time Rswag is run).</span>

<span class="nb">require</span> <span class="s1">&#39;rails_helper&#39;</span>

<span class="n">describe</span> <span class="s1">&#39;Higher-Level Reviews&#39;</span><span class="p">,</span> <span class="ss">swagger_doc</span><span class="p">:</span> <span class="s1">&#39;modules/appeals_api/app/swagger/appeals_api/v2/swagger.json&#39;</span><span class="p">,</span> <span class="ss">type</span><span class="p">:</span> <span class="ss">:request</span> <span class="k">do</span>
  <span class="c1">#                                           ^ this path needs to match one of the paths from your Rswag config</span>
  <span class="c1">#                                                                                                           ^ adding &#39;type: :request&#39; makes sure that RSpec knows how to properly interpret your spec if it lives outside of the &#39;spec/requests&#39; path</span>

  <span class="n">path</span> <span class="s1">&#39;/higher_level_reviews/{uuid}&#39;</span> <span class="k">do</span>
    <span class="c1"># ^ this should be the actual url fragment you want Rswag to make a request to</span>

    <span class="n">let</span><span class="p">(</span><span class="ss">:apikey</span><span class="p">)</span> <span class="p">{</span> <span class="s1">&#39;apikey&#39;</span> <span class="p">}</span>

    <span class="n">get</span> <span class="s1">&#39;Shows a specific Higher-Level Review. (a.k.a. the Show endpoint)&#39;</span> <span class="k">do</span>
      <span class="n">tags</span> <span class="s1">&#39;Higher-Level Reviews&#39;</span>
      <span class="c1"># ^ Which tag(s) should this example be nested in (from the rswag config)</span>

      <span class="n">operationId</span> <span class="s1">&#39;showHlr&#39;</span>
      <span class="c1"># ^ unique Id that will be used by the swagger UI</span>

      <span class="n">security</span> <span class="o">[</span>
        <span class="p">{</span> <span class="ss">apikey</span><span class="p">:</span> <span class="o">[]</span> <span class="p">}</span>
      <span class="o">]</span>
      <span class="c1"># ^ relevant security schemes (from Rswag config)</span>

      <span class="n">consumes</span> <span class="s1">&#39;application/json&#39;</span>
      <span class="n">produces</span> <span class="s1">&#39;application/json&#39;</span>

      <span class="n">parameter</span> <span class="nb">name</span><span class="p">:</span> <span class="ss">:uuid</span><span class="p">,</span> <span class="k">in</span><span class="p">:</span> <span class="ss">:path</span><span class="p">,</span> <span class="ss">type</span><span class="p">:</span> <span class="ss">:string</span><span class="p">,</span> <span class="ss">description</span><span class="p">:</span> <span class="s1">&#39;Higher-Level Review UUID&#39;</span>
      <span class="c1">#         ^ name&#39;s value is important - it will be set by its value in the &#39;response&#39; section</span>

      <span class="n">response</span> <span class="s1">&#39;200&#39;</span><span class="p">,</span> <span class="s1">&#39;Info about a single Higher-Level Review&#39;</span> <span class="k">do</span>
        <span class="n">schema</span> <span class="ss">type</span><span class="p">:</span> <span class="ss">:object</span><span class="p">,</span>
          <span class="ss">properties</span><span class="p">:</span> <span class="p">{</span>
            <span class="ss">data</span><span class="p">:</span> <span class="p">{</span>
              <span class="ss">properties</span><span class="p">:</span> <span class="p">{</span>
                <span class="nb">id</span><span class="p">:</span> <span class="p">{</span>
                  <span class="ss">type</span><span class="p">:</span> <span class="ss">:string</span><span class="p">,</span>
                  <span class="ss">pattern</span><span class="p">:</span> <span class="s1">&#39;^[0-9a-fA-F]{8}(-[0-9a-fA-F]{4}){3}-[0-9a-fA-F]{12}$&#39;</span>
                <span class="p">},</span>
                <span class="ss">type</span><span class="p">:</span> <span class="p">{</span>
                  <span class="ss">type</span><span class="p">:</span> <span class="ss">:string</span><span class="p">,</span>
                  <span class="ss">enum</span><span class="p">:</span> <span class="o">[</span><span class="s1">&#39;higherLevelReview&#39;</span><span class="o">]</span>
                <span class="p">},</span>
                <span class="ss">attributes</span><span class="p">:</span> <span class="p">{</span>
                  <span class="ss">properties</span><span class="p">:</span> <span class="p">{</span>
                    <span class="ss">status</span><span class="p">:</span> <span class="p">{</span>
                      <span class="ss">type</span><span class="p">:</span> <span class="ss">:string</span><span class="p">,</span>
                      <span class="ss">example</span><span class="p">:</span> <span class="no">AppealsApi</span><span class="o">::</span><span class="no">HlrStatus</span><span class="o">::</span><span class="no">V2_STATUSES</span><span class="o">.</span><span class="n">first</span><span class="p">,</span>
                      <span class="ss">enum</span><span class="p">:</span> <span class="no">AppealsApi</span><span class="o">::</span><span class="no">HlrStatus</span><span class="o">::</span><span class="no">V2_STATUSES</span>
                    <span class="p">},</span>
                    <span class="ss">updatedAt</span><span class="p">:</span> <span class="p">{</span>
                      <span class="ss">type</span><span class="p">:</span> <span class="ss">:string</span><span class="p">,</span>
                      <span class="ss">pattern</span><span class="p">:</span> <span class="s1">&#39;\d{4}(-\d{2}){2}T\d{2}(:\d{2}){2}\.\d{3}Z&#39;</span>
                    <span class="p">},</span>
                    <span class="ss">createdAt</span><span class="p">:</span> <span class="p">{</span>
                      <span class="ss">type</span><span class="p">:</span> <span class="ss">:string</span><span class="p">,</span>
                      <span class="ss">pattern</span><span class="p">:</span> <span class="s1">&#39;\d{4}(-\d{2}){2}T\d{2}(:\d{2}){2}\.\d{3}Z&#39;</span>
                    <span class="p">},</span>
                    <span class="ss">formData</span><span class="p">:</span> <span class="p">{</span>
                      <span class="s1">&#39;$ref&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;#/components/schemas/hlrCreate&#39;</span>
                    <span class="p">}</span>
                  <span class="p">}</span>
                <span class="p">}</span>
              <span class="p">},</span>
              <span class="ss">required</span><span class="p">:</span> <span class="sx">%w[id type attributes]</span>
            <span class="p">}</span>
          <span class="p">},</span>
          <span class="ss">required</span><span class="p">:</span> <span class="o">[</span><span class="s1">&#39;data&#39;</span><span class="o">]</span>
          <span class="c1"># schemas can be defined several ways:</span>
          <span class="c1">#   inline (as shown above):</span>
          <span class="c1">#       schema type: :object, ...</span>
          <span class="c1">#   referenced from the Rswag config:</span>
          <span class="c1">#       schema &#39;$ref&#39; =&gt; &#39;#/components/schemas/errors_object&#39;</span>
          <span class="c1">#   or loaded from plain json files:</span>
          <span class="c1">#       schema JSON.parse(File.read(AppealsApi::Engine.root.join(&#39;spec&#39;, &#39;support&#39;, &#39;schemas&#39;, &#39;errors&#39;, &#39;404.json&#39;)))</span>

        <span class="n">let</span><span class="p">(</span><span class="ss">:uuid</span><span class="p">)</span> <span class="p">{</span> <span class="no">FactoryBot</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="ss">:minimal_higher_level_review_v2</span><span class="p">)</span><span class="o">.</span><span class="n">id</span> <span class="p">}</span>
        <span class="c1"># ^ needs to match the parameters name otherwise you&#39;ll see a No method error for &#39;uuid&#39; (or whatever your parameter is called)</span>

        <span class="n">before</span> <span class="k">do</span> <span class="o">|</span><span class="n">example</span><span class="o">|</span>
          <span class="n">submit_request</span><span class="p">(</span><span class="n">example</span><span class="o">.</span><span class="n">metadata</span><span class="p">)</span>
          <span class="c1"># ^ makes the actual request - using the built up url (fragment and basePath) and any parameters you have supplied</span>
        <span class="k">end</span>

        <span class="n">it</span> <span class="s1">&#39;returns a 200 response&#39;</span> <span class="k">do</span> <span class="o">|</span><span class="n">example</span><span class="o">|</span>
          <span class="n">assert_response_matches_metadata</span><span class="p">(</span><span class="n">example</span><span class="o">.</span><span class="n">metadata</span><span class="p">)</span>
          <span class="c1"># ^ asserts that the respose matches the schema you have supplied</span>
        <span class="k">end</span>

        <span class="n">after</span> <span class="k">do</span> <span class="o">|</span><span class="n">example</span><span class="o">|</span>
          <span class="n">example</span><span class="o">.</span><span class="n">metadata</span><span class="o">[</span><span class="ss">:response</span><span class="o">][</span><span class="ss">:content</span><span class="o">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;application/json&#39;</span> <span class="o">=&gt;</span> <span class="p">{</span>
              <span class="ss">example</span><span class="p">:</span> <span class="no">JSON</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">body</span><span class="p">,</span> <span class="ss">symbolize_names</span><span class="p">:</span> <span class="kp">true</span><span class="p">)</span>
              <span class="c1"># ^ saves the actual response from the &#39;submit_request(example.metadata)&#39; call in the before action</span>
            <span class="p">}</span>
          <span class="p">}</span>
        <span class="k">end</span>
      <span class="k">end</span>

      <span class="n">response</span> <span class="s1">&#39;404&#39;</span><span class="p">,</span> <span class="s1">&#39;Higher-Level Review not found&#39;</span> <span class="k">do</span>
        <span class="n">schema</span> <span class="no">JSON</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="no">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="no">AppealsApi</span><span class="o">::</span><span class="no">Engine</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;spec&#39;</span><span class="p">,</span> <span class="s1">&#39;support&#39;</span><span class="p">,</span> <span class="s1">&#39;schemas&#39;</span><span class="p">,</span> <span class="s1">&#39;errors&#39;</span><span class="p">,</span> <span class="s1">&#39;404.json&#39;</span><span class="p">)))</span>

        <span class="n">let</span><span class="p">(</span><span class="ss">:uuid</span><span class="p">)</span> <span class="p">{</span> <span class="s1">&#39;invalid&#39;</span> <span class="p">}</span>

        <span class="n">before</span> <span class="k">do</span> <span class="o">|</span><span class="n">example</span><span class="o">|</span>
          <span class="n">submit_request</span><span class="p">(</span><span class="n">example</span><span class="o">.</span><span class="n">metadata</span><span class="p">)</span>
        <span class="k">end</span>

        <span class="n">after</span> <span class="k">do</span> <span class="o">|</span><span class="n">example</span><span class="o">|</span>
          <span class="n">example</span><span class="o">.</span><span class="n">metadata</span><span class="o">[</span><span class="ss">:response</span><span class="o">][</span><span class="ss">:content</span><span class="o">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;application/json&#39;</span> <span class="o">=&gt;</span> <span class="p">{</span>
              <span class="ss">example</span><span class="p">:</span> <span class="no">JSON</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">body</span><span class="p">,</span> <span class="ss">symbolize_names</span><span class="p">:</span> <span class="kp">true</span><span class="p">)</span>
            <span class="p">}</span>
          <span class="p">}</span>
        <span class="k">end</span>

        <span class="n">it</span> <span class="s1">&#39;returns a 404 response&#39;</span> <span class="k">do</span> <span class="o">|</span><span class="n">example</span><span class="o">|</span>
          <span class="n">assert_response_matches_metadata</span><span class="p">(</span><span class="n">example</span><span class="o">.</span><span class="n">metadata</span><span class="p">)</span>
        <span class="k">end</span>
      <span class="k">end</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></td></tr></table></div>
<ul>
<li>Run the custom rake task you created earlier to run Rswag and generate the swagger json file <code>rake rswag:appeals_api:run</code></li>
<li>Serve the generated swagger from your doc controller:</li>
</ul>
<div class="language-ruby highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">AppealsApi</span><span class="o">::</span><span class="no">Docs</span><span class="o">::</span><span class="no">V2</span><span class="o">::</span><span class="no">DocsController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>
  <span class="n">skip_before_action</span><span class="p">(</span><span class="ss">:authenticate</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">decision_reviews</span>
    <span class="n">swagger</span> <span class="o">=</span> <span class="no">JSON</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="no">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="no">AppealsApi</span><span class="o">::</span><span class="no">Engine</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;app/swagger/appeals_api/v2/swagger.json&#39;</span><span class="p">)))</span>
    <span class="n">render</span> <span class="ss">json</span><span class="p">:</span> <span class="n">swagger</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></td></tr></table></div>
<hr />
<h3 id="misc-details">Misc details<a class="headerlink" href="#misc-details" title="Permanent link">&para;</a></h3>
<ul>
<li>Make sure that if you are creating any resources (FactoryBot or otherwise) they happen lazily (ie inside a <code>let</code>, <code>before</code>, or <code>it</code>). If you put them inside the <code>response</code> block (or anywhere else that gets evaluated on load) Rspec will evaluate and run them when it is loading all the files up for a suite run - and then because they were not created in the typical way they won't get cleaned up properly at the end of the spec run... This can lead to confusion if you use specific counts of that resource anywhere else in your specs.</li>
</ul>
<ul>
<li>How to add multiple request bodies and responses to Rswag examples (examples truncated for brevity):</li>
</ul>
<div class="language-ruby highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># ...</span>
<span class="n">describe</span> <span class="s1">&#39;Higher-Level Reviews&#39;</span><span class="p">,</span> <span class="ss">swagger_doc</span><span class="p">:</span> <span class="s1">&#39;modules/appeals_api/app/swagger/appeals_api/v2/swagger.json&#39;</span><span class="p">,</span> <span class="ss">type</span><span class="p">:</span> <span class="ss">:request</span> <span class="k">do</span>
  <span class="n">let</span><span class="p">(</span><span class="ss">:apikey</span><span class="p">)</span> <span class="p">{</span> <span class="s1">&#39;apikey&#39;</span> <span class="p">}</span>

  <span class="n">path</span> <span class="s1">&#39;/higher_level_reviews&#39;</span> <span class="k">do</span>
    <span class="n">post</span> <span class="s1">&#39;Creates a new Higher-Level Review&#39;</span> <span class="k">do</span>
      <span class="c1"># tags, operationId, description, etc</span>

      <span class="n">parameter</span> <span class="nb">name</span><span class="p">:</span> <span class="ss">:hlr_body</span><span class="p">,</span> <span class="k">in</span><span class="p">:</span> <span class="ss">:body</span><span class="p">,</span> <span class="ss">schema</span><span class="p">:</span> <span class="p">{</span> <span class="s1">&#39;$ref&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;#/components/schemas/hlrCreate&#39;</span> <span class="p">}</span>
      <span class="c1"># =&gt;            ^ as stated before the value passed to the name: parameter is important as you will need to set its value later)</span>

      <span class="n">parameter</span> <span class="k">in</span><span class="p">:</span> <span class="ss">:body</span><span class="p">,</span> <span class="ss">examples</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;minimum fields used&#39;</span> <span class="o">=&gt;</span> <span class="p">{</span>
          <span class="ss">value</span><span class="p">:</span> <span class="no">JSON</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="no">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="no">AppealsApi</span><span class="o">::</span><span class="no">Engine</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;spec&#39;</span><span class="p">,</span> <span class="s1">&#39;fixtures&#39;</span><span class="p">,</span> <span class="s1">&#39;v2&#39;</span><span class="p">,</span> <span class="s1">&#39;valid_200996_minimum.json&#39;</span><span class="p">)))</span>
        <span class="p">},</span>
        <span class="s1">&#39;all fields used&#39;</span> <span class="o">=&gt;</span> <span class="p">{</span>
          <span class="ss">value</span><span class="p">:</span> <span class="no">JSON</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="no">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="no">AppealsApi</span><span class="o">::</span><span class="no">Engine</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;spec&#39;</span><span class="p">,</span> <span class="s1">&#39;fixtures&#39;</span><span class="p">,</span> <span class="s1">&#39;v2&#39;</span><span class="p">,</span> <span class="s1">&#39;valid_200996.json&#39;</span><span class="p">)))</span>
        <span class="p">}</span>
      <span class="p">}</span>
      <span class="c1"># ^ the value of keys in the examples hash will be used in the request bodies drop down selector</span>

      <span class="n">parameter</span> <span class="k">in</span><span class="p">:</span> <span class="ss">:header</span><span class="p">,</span>
        <span class="ss">type</span><span class="p">:</span> <span class="ss">:string</span><span class="p">,</span>
        <span class="nb">name</span><span class="p">:</span> <span class="s1">&#39;X-VA-SSN&#39;</span><span class="p">,</span>
        <span class="ss">required</span><span class="p">:</span> <span class="kp">true</span><span class="p">,</span>
        <span class="ss">description</span><span class="p">:</span> <span class="s1">&#39;Veteran</span><span class="se">\&#39;</span><span class="s1">s SSN&#39;</span>

      <span class="n">let</span><span class="p">(</span><span class="ss">:&#39;X-VA-SSN&#39;</span><span class="p">)</span> <span class="p">{</span> <span class="s1">&#39;000000000&#39;</span> <span class="p">}</span>

      <span class="n">response</span> <span class="s1">&#39;200&#39;</span><span class="p">,</span> <span class="s1">&#39;Info about a single Higher-Level Review&#39;</span> <span class="k">do</span>
        <span class="n">let</span><span class="p">(</span><span class="ss">:hlr_body</span><span class="p">)</span> <span class="k">do</span>
          <span class="no">JSON</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="no">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="no">AppealsApi</span><span class="o">::</span><span class="no">Engine</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;spec&#39;</span><span class="p">,</span> <span class="s1">&#39;fixtures&#39;</span><span class="p">,</span> <span class="s1">&#39;v2&#39;</span><span class="p">,</span> <span class="s1">&#39;valid_200996_minimum.json&#39;</span><span class="p">)))</span>
        <span class="k">end</span>
        <span class="c1"># ^ referencing the parameter named above (:hlr_body) so Rswag knows to send this json as the body of the request</span>

        <span class="c1"># schema ...</span>

        <span class="n">before</span> <span class="k">do</span> <span class="o">|</span><span class="n">example</span><span class="o">|</span>
          <span class="n">submit_request</span><span class="p">(</span><span class="n">example</span><span class="o">.</span><span class="n">metadata</span><span class="p">)</span>
        <span class="k">end</span>

        <span class="n">it</span> <span class="s1">&#39;minimum fields used&#39;</span> <span class="k">do</span> <span class="o">|</span><span class="n">example</span><span class="o">|</span>
          <span class="n">assert_response_matches_metadata</span><span class="p">(</span><span class="n">example</span><span class="o">.</span><span class="n">metadata</span><span class="p">)</span>
        <span class="k">end</span>

        <span class="n">after</span> <span class="k">do</span> <span class="o">|</span><span class="n">example</span><span class="o">|</span>
          <span class="n">response_title</span> <span class="o">=</span> <span class="n">example</span><span class="o">.</span><span class="n">metadata</span><span class="o">[</span><span class="ss">:description</span><span class="o">]</span>
          <span class="n">example</span><span class="o">.</span><span class="n">metadata</span><span class="o">[</span><span class="ss">:response</span><span class="o">][</span><span class="ss">:content</span><span class="o">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;application/json&#39;</span> <span class="o">=&gt;</span> <span class="p">{</span>
              <span class="ss">examples</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;</span><span class="si">#{</span><span class="n">response_title</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="p">{</span>
                  <span class="ss">value</span><span class="p">:</span> <span class="no">JSON</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">body</span><span class="p">,</span> <span class="ss">symbolize_names</span><span class="p">:</span> <span class="kp">true</span><span class="p">)</span>
                <span class="p">}</span>
              <span class="p">}</span>
              <span class="c1"># ^ To have multiple responses (shown in the swagger UI via a drop down) you have to nest them under &#39;examples&#39; instead of directly in &#39;example&#39;</span>
              <span class="c1">#   You can set the text statically here or use the examples metadata from the &#39;it ... do&#39; - in this case &#39;minimum fields used&#39;. Providing that you don&#39;t over write it with a subsequent example.</span>
            <span class="p">}</span>
          <span class="p">}</span>
        <span class="k">end</span>
      <span class="k">end</span>

      <span class="n">response</span> <span class="s1">&#39;200&#39;</span><span class="p">,</span> <span class="s1">&#39;Info about a single Higher-Level Review&#39;</span> <span class="k">do</span>
        <span class="n">let</span><span class="p">(</span><span class="ss">:hlr_body</span><span class="p">)</span> <span class="k">do</span>
          <span class="no">JSON</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="no">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="no">AppealsApi</span><span class="o">::</span><span class="no">Engine</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;spec&#39;</span><span class="p">,</span> <span class="s1">&#39;fixtures&#39;</span><span class="p">,</span> <span class="s1">&#39;v2&#39;</span><span class="p">,</span> <span class="s1">&#39;valid_200996.json&#39;</span><span class="p">)))</span>
        <span class="k">end</span>

        <span class="c1"># schema ...</span>

        <span class="n">before</span> <span class="k">do</span> <span class="o">|</span><span class="n">example</span><span class="o">|</span>
          <span class="n">submit_request</span><span class="p">(</span><span class="n">example</span><span class="o">.</span><span class="n">metadata</span><span class="p">)</span>
        <span class="k">end</span>

        <span class="n">it</span> <span class="s1">&#39;all fields used&#39;</span> <span class="k">do</span> <span class="o">|</span><span class="n">example</span><span class="o">|</span>
          <span class="n">assert_response_matches_metadata</span><span class="p">(</span><span class="n">example</span><span class="o">.</span><span class="n">metadata</span><span class="p">)</span>
        <span class="k">end</span>
        <span class="c1"># ^ This is another &#39;200&#39; response but because the description is different than the above &#39;200&#39; example it will show up as two different possible examples in the swagger UI</span>

        <span class="n">after</span> <span class="k">do</span> <span class="o">|</span><span class="n">example</span><span class="o">|</span>
          <span class="n">response_title</span> <span class="o">=</span> <span class="n">example</span><span class="o">.</span><span class="n">metadata</span><span class="o">[</span><span class="ss">:description</span><span class="o">]</span>
          <span class="n">example</span><span class="o">.</span><span class="n">metadata</span><span class="o">[</span><span class="ss">:response</span><span class="o">][</span><span class="ss">:content</span><span class="o">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;application/json&#39;</span> <span class="o">=&gt;</span> <span class="p">{</span>
              <span class="ss">examples</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;</span><span class="si">#{</span><span class="n">response_title</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="p">{</span>
                  <span class="ss">value</span><span class="p">:</span> <span class="no">JSON</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">body</span><span class="p">,</span> <span class="ss">symbolize_names</span><span class="p">:</span> <span class="kp">true</span><span class="p">)</span>
                <span class="p">}</span>
              <span class="p">}</span>
            <span class="p">}</span>
          <span class="p">}</span>
        <span class="k">end</span>
      <span class="k">end</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></td></tr></table></div>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../mpi/" class="md-footer__link md-footer__link--prev" aria-label="Previous: MPI Service" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              MPI Service
            </div>
          </div>
        </a>
      
      
        
        <a href="../running_docker/" class="md-footer__link md-footer__link--next" aria-label="Next: Running the app with Docker" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Running the app with Docker
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.092fa1f6.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.5a9542cf.min.js"></script>
      
    
  </body>
</html>